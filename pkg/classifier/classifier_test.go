package classifier

import (
	"encoding/hex"
	"testing"

	"github.com/stretchr/testify/assert"
)

func TestIsErc20(t *testing.T) {
	type args struct {
		bytecode string
	}

	tests := []struct {
		name string
		args args
		want bool
	}{
		{name: "emoticon contract bytecode",
			args: args{
				bytecode: "6080604052600436106102815760003560e01c806389375abf1161014f578063bac154ea116100c1578063dd62ed3e1161007a578063dd62ed3e1461073b578063f0d00f2e14610781578063f2fde38b14610797578063f7d04321146107b7578063f887ea40146107cd578063f8b45b051461080157600080fd5b8063bac154ea146106a5578063bc7e68a3146106ba578063c5377ae5146106d0578063c5c0050e146106f0578063cf46f24c1461070f578063da07e4d71461072557600080fd5b80639367ffcd116101135780639367ffcd146105f157806395d89b41146106065780639833d9ec1461061b578063a457c2d714610631578063a8aa1b3114610651578063a9059cbb1461068557600080fd5b806389375abf1461056957806389d81e9d1461057f5780638a8c523c1461059f5780638da5cb5b146105b45780639079f932146105d757600080fd5b80633fc8cef3116101f35780636ac5eeee116101ac5780636ac5eeee146104d557806370a08231146104ea578063713be5ef1461050a578063715018a61461051f57806374c9f60314610534578063751039fc1461055457600080fd5b80633fc8cef31461042857806342295e1b1461045c5780634a62bb65146104715780636135af2a1461048b57806361a9d1b1146104ab57806363eab10a146104c057600080fd5b80632dc0562d116102455780632dc0562d1461033d5780632e32598314610375578063313ce5671461039757806339509351146103b95780633af32abf146103d95780633b68edea1461040957600080fd5b806303e2c14c1461028d57806306fdde03146102b6578063095ea7b3146102d857806318160ddd1461030857806323b872dd1461031d57600080fd5b3661028857005b600080fd5b34801561029957600080fd5b506102a3600d5481565b6040519081526020015b60405180910390f35b3480156102c257600080fd5b506102cb610817565b6040516102ad9190611d46565b3480156102e457600080fd5b506102f86102f3366004611db9565b6108a9565b60405190151581526020016102ad565b34801561031457600080fd5b506013546102a3565b34801561032957600080fd5b506102f8610338366004611de5565b610916565b34801561034957600080fd5b50600b5461035d906001600160a01b031681565b6040516001600160a01b0390911681526020016102ad565b34801561038157600080fd5b50610395610390366004611ede565b610a34565b005b3480156103a357600080fd5b5060025460405160ff90911681526020016102ad565b3480156103c557600080fd5b506102f86103d4366004611db9565b610ac2565b3480156103e557600080fd5b506102f86103f4366004611f1b565b60116020526000908152604090205460ff1681565b34801561041557600080fd5b506012546102f890610100900460ff1681565b34801561043457600080fd5b5061035d7f000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc281565b34801561046857600080fd5b50610395610b48565b34801561047d57600080fd5b506012546102f89060ff1681565b34801561049757600080fd5b506103956104a6366004611f4f565b610bf2565b3480156104b757600080fd5b50610395610c4c565b3480156104cc57600080fd5b506102f8610c99565b3480156104e157600080fd5b50610395610ced565b3480156104f657600080fd5b506102a3610505366004611f1b565b610d6c565b34801561051657600080fd5b506102cb610d93565b34801561052b57600080fd5b50610395610e21565b34801561054057600080fd5b5061039561054f366004611f1b565b610e9f565b34801561056057600080fd5b50610395610f35565b34801561057557600080fd5b506102a360035481565b34801561058b57600080fd5b5061039561059a366004611f84565b610fe4565b3480156105ab57600080fd5b506103956110b8565b3480156105c057600080fd5b5060025461010090046001600160a01b031661035d565b3480156105e357600080fd5b506006546102f89060ff1681565b3480156105fd57600080fd5b506102cb611190565b34801561061257600080fd5b506102cb61119d565b34801561062757600080fd5b506102a360085481565b34801561063d57600080fd5b506102f861064c366004611db9565b6111ac565b34801561065d57600080fd5b5061035d7f000000000000000000000000fffa78c979c2f787b16eac7c7e9c77b11feb77fb81565b34801561069157600080fd5b506102f86106a0366004611db9565b611293565b3480156106b157600080fd5b506102cb6112bf565b3480156106c657600080fd5b506102a360045481565b3480156106dc57600080fd5b506103956106eb366004611fa6565b6112cc565b3480156106fc57600080fd5b506006546102f890610100900460ff1681565b34801561071b57600080fd5b506102a360095481565b34801561073157600080fd5b506102a360055481565b34801561074757600080fd5b506102a3610756366004611feb565b6001600160a01b03918216600090815260176020908152604080832093909416825291909152205490565b34801561078d57600080fd5b506102a360075481565b3480156107a357600080fd5b506103956107b2366004611f1b565b611362565b3480156107c357600080fd5b506102a3600c5481565b3480156107d957600080fd5b5061035d7f0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d81565b34801561080d57600080fd5b506102a3600a5481565b60606000805461082690612024565b80601f016020809104026020016040519081016040528092919081815260200182805461085290612024565b801561089f5780601f106108745761010080835404028352916020019161089f565b820191906000526020600020905b81548152906001019060200180831161088257829003601f168201915b5050505050905090565b3360008181526017602090815260408083206001600160a01b038716808552925280832085905551919290917f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925906109049086815260200190565b60405180910390a35060015b92915050565b6000826001600160a01b03811661092c57600080fd5b6001600160a01b038516600090815260176020908152604080832033845290915290205460001914610a1d576001600160a01b03851660009081526017602090815260408083203384529091529020548311156109c95760405162461bcd60e51b8152602060048201526016602482015275496e73756666696369656e7420416c6c6f77616e636560501b60448201526064015b60405180910390fd5b6001600160a01b03851660009081526017602090815260408083203384529091529020546109f8908490612074565b6001600160a01b03861660009081526017602090815260408083203384529091529020555b610a2885858561139a565b50600195945050505050565b6000805b8251811015610abd57828181518110610a5357610a53612087565b60200260200101519150816001600160a01b0316826001600160a01b03167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef6000604051610aa391815260200190565b60405180910390a380610ab58161209d565b915050610a38565b505050565b3360009081526017602090815260408083206001600160a01b0386168452909152812054610af19083906120b6565b3360008181526017602090815260408083206001600160a01b038916808552908352928190208590555193845290927f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9259101610904565b60025461010090046001600160a01b03163314610b775760405162461bcd60e51b81526004016109c0906120c9565b600654610100900460ff1615610bc15760405162461bcd60e51b815260206004820152600f60248201526e185b1c9958591e481cdd185c9d1959608a1b60448201526064016109c0565b600354610bce90426120b6565b600455610bde42621275006120b6565b6005556006805461ff001916610100179055565b60025461010090046001600160a01b03163314610c215760405162461bcd60e51b81526004016109c0906120c9565b6001600160a01b03919091166000908152601160205260409020805460ff1916911515919091179055565b610c54610c99565b610c8e5760405162461bcd60e51b815260206004820152600b60248201526a4e6f7420696e2074696d6560a81b60448201526064016109c0565b610c96611892565b50565b600042600454111580610ce8575060065460ff168015610cc05750600654610100900460ff165b8015610cce5750600a600754105b8015610ce8575042600854603c610ce591906120b6565b11155b905090565b6019805460ff191660011790556000610d0530610d6c565b905080600003610d155750610d60565b601454601554610d259190612102565b610d30906014612116565b811115610d5557601454601554610d479190612102565b610d52906014612116565b90505b610d5e81611ac9565b505b6019805460ff19169055565b6014546001600160a01b038216600090815260166020526040812054909161091091612102565b600e8054610da090612024565b80601f0160208091040260200160405190810160405280929190818152602001828054610dcc90612024565b8015610e195780601f10610dee57610100808354040283529160200191610e19565b820191906000526020600020905b815481529060010190602001808311610dfc57829003601f168201915b505050505081565b60025461010090046001600160a01b03163314610e505760405162461bcd60e51b81526004016109c0906120c9565b6002546040516101009091046001600160a01b0316907ff8df31144d9c2f0f6b59d69b8b98abd5459d07f2742c4df920b25aae33c6482090600090a260028054610100600160a81b0319169055565b60025461010090046001600160a01b03163314610ece5760405162461bcd60e51b81526004016109c0906120c9565b6001600160a01b038116610f135760405162461bcd60e51b815260206004820152600c60248201526b5a65726f204164647265737360a01b60448201526064016109c0565b600b80546001600160a01b0319166001600160a01b0392909216919091179055565b60025461010090046001600160a01b03163314610f645760405162461bcd60e51b81526004016109c0906120c9565b60125460ff16610faf5760405162461bcd60e51b8152602060048201526016602482015275131a5b5a5d1cc8185b1c9958591e481c995b5bdd995960521b60448201526064016109c0565b6012805460ff191690556040517fa4ffae85e880608d5d4365c2b682786545d136145537788e7e0940dff9f0b98c90600090a1565b60025461010090046001600160a01b031633146110135760405162461bcd60e51b81526004016109c0906120c9565b600c54821115806110255750600a8211155b6110605760405162461bcd60e51b815260206004820152600c60248201526b0a8c2f040e8dede40d0d2ced60a31b60448201526064016109c0565b600d54811115806110725750600a8111155b6110ad5760405162461bcd60e51b815260206004820152600c60248201526b0a8c2f040e8dede40d0d2ced60a31b60448201526064016109c0565b600c91909155600d55565b60025461010090046001600160a01b031633146110e75760405162461bcd60e51b81526004016109c0906120c9565b601254610100900460ff16156111365760405162461bcd60e51b815260206004820152601460248201527354726164696e67204c69766520416c726561647960601b60448201526064016109c0565b7358df81babdf15276e761808e872a3838cbecbcf960005260186020527ff1149e5eac8fad9a4507403704abfff08a48c094cc4966abf9674c85bafdf071805460ff191660011790556012805461ff001916610100179055565b600f8054610da090612024565b60606001805461082690612024565b3360009081526017602090815260408083206001600160a01b0386168452909152812054808310611200573360009081526017602090815260408083206001600160a01b038816845290915281205561122f565b61120a8382612074565b3360009081526017602090815260408083206001600160a01b03891684529091529020555b3360008181526017602090815260408083206001600160a01b038916808552908352928190205490519081529192917f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925910160405180910390a35060019392505050565b6000826001600160a01b0381166112a957600080fd5b6112b433858561139a565b506001949350505050565b60108054610da090612024565b60025461010090046001600160a01b031633146112fb5760405162461bcd60e51b81526004016109c0906120c9565b60005b8251811015610abd57816018600085848151811061131e5761131e612087565b6020908102919091018101516001600160a01b03168252810191909152604001600020805460ff19169115159190911790558061135a8161209d565b9150506112fe565b60025461010090046001600160a01b031633146113915760405162461bcd60e51b81526004016109c0906120c9565b610c9681611c51565b6014546000907f000000000000000000000000fffa78c979c2f787b16eac7c7e9c77b11feb77fb9082906113ce9085612116565b6001600160a01b03871660009081526018602052604090205490915060ff1615801561141357506001600160a01b03851660009081526018602052604090205460ff16155b801561142f57503360009081526018602052604090205460ff16155b6114695760405162461bcd60e51b815260206004820152600b60248201526a109b1858dadb1a5cdd195960aa1b60448201526064016109c0565b60065460ff16801561147e575060195460ff16155b80156114a357506001600160a01b03861660009081526011602052604090205460ff16155b80156114c857506001600160a01b03851660009081526011602052604090205460ff16155b156117d157601254610100900460ff166115175760405162461bcd60e51b815260206004820152601060248201526f54726164696e67206e6f74206c69766560801b60448201526064016109c0565b60125460ff161561161057816001600160a01b0316866001600160a01b031614806115535750816001600160a01b0316856001600160a01b0316145b1561159c5760095484111561159c5760405162461bcd60e51b815260206004820152600f60248201526e13585e08151e08115e18d959591959608a1b60448201526064016109c0565b816001600160a01b0316856001600160a01b03161461161057600a54846115c287610d6c565b6115cc91906120b6565b11156116105760405162461bcd60e51b815260206004820152601360248201527213585e0815d85b1b195d08115e18d959591959606a1b60448201526064016109c0565b816001600160a01b0316856001600160a01b0316036116ac576014546015546116399190612102565b61164230610d6c565b1061169557306001600160a01b0316636ac5eeee6040518163ffffffff1660e01b8152600401600060405180830381600087803b15801561168257600080fd5b505af1925050508015611693575060015b505b61169d610c99565b156116ac576116aa611892565b505b6000826001600160a01b0316876001600160a01b0316036116e8576064600c54836116d79190612116565b6116e19190612102565b905061171e565b826001600160a01b0316866001600160a01b03160361171e576064600d54836117119190612116565b61171b9190612102565b90505b80156117cf576001600160a01b0387166000908152601660205260408120805483929061174c908490612074565b909155505030600090815260166020526040812080548392906117709084906120b6565b909155505060145430906001600160a01b038916907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef906117b19085612102565b60405190815260200160405180910390a36117cc8183612074565b91505b505b6001600160a01b0386166000908152601660205260409020546117f5908290612074565b6001600160a01b0380881660009081526016602052604080822093909355908716815220546118259082906120b6565b6001600160a01b03808716600081815260166020526040902092909255601454908816907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef906118759085612102565b60405190815260200160405180910390a350600195945050505050565b6000804290506000606460135460026118ab9190612116565b6118b59190612102565b90504260045410156118e6576001600755600354600480546000906118db9084906120b6565b909155506119039050565b6001600760008282546118f991906120b6565b9091555050426008555b8060000361195157817f11c6bf55864ff83827df712625d7a80e5583eef0264921025e7cd22003a2151160135460405161193f91815260200190565b60405180910390a26013549250505090565b8060135461195f9190612074565b60135560055460045410611a48576000196004556006805460ff1916905560025460ff1661198e90600a612211565b61199c90632e5bf271612116565b60135560125460ff16156119de576012805460ff191690556040517fa4ffae85e880608d5d4365c2b682786545d136145537788e7e0940dff9f0b98c90600090a15b60006119e930610d6c565b1115611a3d57306001600160a01b0316636ac5eeee6040518163ffffffff1660e01b8152600401600060405180830381600087803b158015611a2a57600080fd5b505af1925050508015611a3b575060015b505b6000600c819055600d555b601354611a576009600a612211565b611a68906640ca664660b5a0612116565b611a7490600019612220565b611a8090600019612074565b611a8a9190612102565b601455611a95611ccb565b817f11c6bf55864ff83827df712625d7a80e5583eef0264921025e7cd22003a2151160135460405161193f91815260200190565b6040805160028082526060820183526000926020830190803683370190505090503081600081518110611afe57611afe612087565b60200260200101906001600160a01b031690816001600160a01b0316815250507f0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d6001600160a01b031663ad5c46486040518163ffffffff1660e01b8152600401602060405180830381865afa158015611b7c573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190611ba09190612234565b81600181518110611bb357611bb3612087565b6001600160a01b039283166020918202929092010152600b5460405163791ac94760e01b81527f0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d83169263791ac94792611c1b92879260009288929116904290600401612251565b600060405180830381600087803b158015611c3557600080fd5b505af1158015611c49573d6000803e3d6000fd5b505050505050565b6001600160a01b038116611c6457600080fd5b6002546040516001600160a01b0380841692610100900416907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600090a3600280546001600160a01b0390921661010002610100600160a81b0319909216919091179055565b60007f000000000000000000000000fffa78c979c2f787b16eac7c7e9c77b11feb77fb9050806001600160a01b031663fff6cae96040518163ffffffff1660e01b8152600401600060405180830381600087803b158015611d2b57600080fd5b505af1158015611d3f573d6000803e3d6000fd5b5050505050565b600060208083528351808285015260005b81811015611d7357858101830151858201604001528201611d57565b506000604082860101526040601f19601f8301168501019250505092915050565b6001600160a01b0381168114610c9657600080fd5b8035611db481611d94565b919050565b60008060408385031215611dcc57600080fd5b8235611dd781611d94565b946020939093013593505050565b600080600060608486031215611dfa57600080fd5b8335611e0581611d94565b92506020840135611e1581611d94565b929592945050506040919091013590565b634e487b7160e01b600052604160045260246000fd5b600082601f830112611e4d57600080fd5b8135602067ffffffffffffffff80831115611e6a57611e6a611e26565b8260051b604051601f19603f83011681018181108482111715611e8f57611e8f611e26565b604052938452858101830193838101925087851115611ead57600080fd5b83870191505b84821015611ed357611ec482611da9565b83529183019190830190611eb3565b979650505050505050565b600060208284031215611ef057600080fd5b813567ffffffffffffffff811115611f0757600080fd5b611f1384828501611e3c565b949350505050565b600060208284031215611f2d57600080fd5b8135611f3881611d94565b9392505050565b80358015158114611db457600080fd5b60008060408385031215611f6257600080fd5b8235611f6d81611d94565b9150611f7b60208401611f3f565b90509250929050565b60008060408385031215611f9757600080fd5b50508035926020909101359150565b60008060408385031215611fb957600080fd5b823567ffffffffffffffff811115611fd057600080fd5b611fdc85828601611e3c565b925050611f7b60208401611f3f565b60008060408385031215611ffe57600080fd5b823561200981611d94565b9150602083013561201981611d94565b809150509250929050565b600181811c9082168061203857607f821691505b60208210810361205857634e487b7160e01b600052602260045260246000fd5b50919050565b634e487b7160e01b600052601160045260246000fd5b818103818111156109105761091061205e565b634e487b7160e01b600052603260045260246000fd5b6000600182016120af576120af61205e565b5060010190565b808201808211156109105761091061205e565b6020808252600990820152682737ba1037bbb732b960b91b604082015260600190565b634e487b7160e01b600052601260045260246000fd5b600082612111576121116120ec565b500490565b80820281158282048414176109105761091061205e565b600181815b8085111561216857816000190482111561214e5761214e61205e565b8085161561215b57918102915b93841c9390800290612132565b509250929050565b60008261217f57506001610910565b8161218c57506000610910565b81600181146121a257600281146121ac576121c8565b6001915050610910565b60ff8411156121bd576121bd61205e565b50506001821b610910565b5060208310610133831016604e8410600b84101617156121eb575081810a610910565b6121f5838361212d565b80600019048211156122095761220961205e565b029392505050565b6000611f3860ff841683612170565b60008261222f5761222f6120ec565b500690565b60006020828403121561224657600080fd5b8151611f3881611d94565b600060a082018783526020878185015260a0604085015281875180845260c086019150828901935060005b818110156122a15784516001600160a01b03168352938301939183019160010161227c565b50506001600160a01b0396909616606085015250505060800152939250505056fea264697066735822122085cdae55340d26c323bf0beffa8dcb0d49f74e17b588218599ed924c10529f7764736f6c63430008110033",
			},
			want: true},
		//{
		//	name: "BLZ contract bytecode",
		//	args: args{
		//		bytecode: "60606040526004361061015e5763ffffffff7c010000000000000000000000000000000000000000000000000000000060003504166306fdde038114610163578063095ea7b3146101ed57806318160ddd14610223578063188214001461024857806323452b9c1461025b57806323b872dd1461026e5780632a905318146102965780632f54bf6e146102a9578063313ce567146102c85780633c54caa5146102f15780634bb278f3146103045780635b7f415c14610317578063707789c51461032a57806370a082311461034957806374c950fb146103685780638bc04eb71461037b5780638da5cb5b1461038e5780638ea64376146103bd57806395d89b41146103d0578063a9059cbb146103e3578063adcf59ee14610405578063b3f05b9714610424578063c0b6f56114610437578063d153b60c14610456578063dd62ed3e14610469578063e71a78111461048e578063ef326c6d146104a1575b600080fd5b341561016e57600080fd5b6101766104c0565b60405160208082528190810183818151815260200191508051906020019080838360005b838110156101b257808201518382015260200161019a565b50505050905090810190601f1680156101df5780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b34156101f857600080fd5b61020f600160a060020a0360043516602435610569565b604051901515815260200160405180910390f35b341561022e57600080fd5b6102366105d5565b60405190815260200160405180910390f35b341561025357600080fd5b6101766105db565b341561026657600080fd5b61020f610612565b341561027957600080fd5b61020f600160a060020a0360043581169060243516604435610694565b34156102a157600080fd5b6101766106b3565b34156102b457600080fd5b61020f600160a060020a03600435166106ea565b34156102d357600080fd5b6102db6106fe565b60405160ff909116815260200160405180910390f35b34156102fc57600080fd5b61020f610707565b341561030f57600080fd5b61020f61083e565b341561032257600080fd5b6102db6108c4565b341561033557600080fd5b61020f600160a060020a03600435166108c9565b341561035457600080fd5b610236600160a060020a0360043516610981565b341561037357600080fd5b61023661099c565b341561038657600080fd5b6102366109ac565b341561039957600080fd5b6103a16109b8565b604051600160a060020a03909116815260200160405180910390f35b34156103c857600080fd5b6103a16109c7565b34156103db57600080fd5b6101766109d6565b34156103ee57600080fd5b61020f600160a060020a0360043516602435610a49565b341561041057600080fd5b61020f600160a060020a0360043516610a66565b341561042f57600080fd5b61020f610a86565b341561044257600080fd5b61020f600160a060020a0360043516610a96565b341561046157600080fd5b6103a1610b63565b341561047457600080fd5b610236600160a060020a0360043581169060243516610b72565b341561049957600080fd5b61020f610b9d565b34156104ac57600080fd5b61020f600160a060020a0360043516610c25565b6104c8610ea2565b60008054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561055e5780601f106105335761010080835404028352916020019161055e565b820191906000526020600020905b81548152906001019060200180831161054157829003601f168201915b505050505090505b90565b600160a060020a03338116600081815260056020908152604080832094871680845294909152808220859055909291907f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9259085905190815260200160405180910390a350600192915050565b60035490565b60408051908101604052600e81527f426c757a656c6c6520546f6b656e000000000000000000000000000000000000602082015281565b600061061d336106ea565b151560011461062b57600080fd5b600754600160a060020a0316151561064557506001610566565b6007805473ffffffffffffffffffffffffffffffffffffffff191690557f670699162ea7ba4de638b5a57c2148aed9ee8bd69740a5e6a7db727e3886c88b60405160405180910390a150600190565b60006106a03384610c52565b6106ab848484610ca9565b949350505050565b60408051908101604052600381527f424c5a0000000000000000000000000000000000000000000000000000000000602082015281565b600654600160a060020a0390811691161490565b60025460ff1690565b6000806000610715336106ea565b151560011461072357600080fd5b30915061072f82610981565b90508015156107415760009250610839565b600160a060020a03821660009081526004602052604090205461076a908263ffffffff610dbc16565b600160a060020a0380841660009081526004602052604080822093909355600654909116815220546107a2908263ffffffff610dd116565b60068054600160a060020a0390811660009081526004602052604090819020939093559054811691908416907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9084905190815260200160405180910390a37fbce3cc672456937708767d1642a17cacb1962753bd5cff46c8dbd377906a6b4b8160405190815260200160405180910390a1600192505b505090565b6000610849336106ea565b151560011461085757600080fd5b60085460a060020a900460ff161561086e57600080fd5b6008805474ff0000000000000000000000000000000000000000191660a060020a1790557f6823b073d48d6e3a7d385eeb601452d680e74bb46afe3255a7d778f3a9b1768160405160405180910390a150600190565b601281565b60006108d4336106ea565b15156001146108e257600080fd5b600654600160a060020a03838116911614156108fd57600080fd5b30600160a060020a031682600160a060020a03161415151561091e57600080fd5b6008805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a038481169190911791829055167f06171a5d6c06d67b0cfa679c07db377a27d1170797663fd98d395229d8c3650860405160405180910390a2506001919050565b600160a060020a031660009081526004602052604090205490565b6b019d971e4fe8401e7400000081565b670de0b6b3a764000081565b600654600160a060020a031681565b600854600160a060020a031681565b6109de610ea2565b60018054600181600116156101000203166002900480601f01602080910402602001604051908101604052809291908181526020018280546001816001161561010002031660029004801561055e5780601f106105335761010080835404028352916020019161055e565b6000610a553384610c52565b610a5f8383610de3565b9392505050565b6000610a71826106ea565b80610a805750610a8082610c25565b92915050565b60085460a060020a900460ff1681565b6000610aa1336106ea565b1515600114610aaf57600080fd5b600160a060020a0382161515610ac457600080fd5b30600160a060020a031682600160a060020a031614151515610ae557600080fd5b600654600160a060020a0383811691161415610b0057600080fd5b6007805473ffffffffffffffffffffffffffffffffffffffff1916600160a060020a038481169190911791829055167f20f5afdf40bf7b43c89031a5d4369a30b159e512d164aa46124bcb706b4a1caf60405160405180910390a2506001919050565b600754600160a060020a031681565b600160a060020a03918216600090815260056020908152604080832093909416825291909152205490565b60075460009033600160a060020a03908116911614610bbb57600080fd5b60068054600160a060020a0333811673ffffffffffffffffffffffffffffffffffffffff19928316179283905560078054909216909155167f624adc4c72536289dd9d5439ccdeccd8923cb9af95fb626b21935447c77b840760405160405180910390a250600190565b600854600090600160a060020a031615801590610a80575050600854600160a060020a0390811691161490565b600160a060020a0381161515610c6757600080fd5b60085460a060020a900460ff1615610c7e57610ca5565b610c87816106ea565b15610c9157610ca5565b610c9a82610a66565b1515610ca557600080fd5b5050565b600160a060020a038316600090815260046020526040812054610cd2908363ffffffff610dbc16565b600160a060020a0380861660009081526004602090815260408083209490945560058152838220339093168252919091522054610d15908363ffffffff610dbc16565b600160a060020a0380861660009081526005602090815260408083203385168452825280832094909455918616815260049091522054610d5b908363ffffffff610dd116565b600160a060020a03808516600081815260046020526040908190209390935591908616907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9085905190815260200160405180910390a35060019392505050565b600081831015610dcb57600080fd5b50900390565b600082820183811015610a5f57600080fd5b600160a060020a033316600090815260046020526040812054610e0c908363ffffffff610dbc16565b600160a060020a033381166000908152600460205260408082209390935590851681522054610e41908363ffffffff610dd116565b600160a060020a0380851660008181526004602052604090819020939093559133909116907fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9085905190815260200160405180910390a350600192915050565b602060405190810160405260008152905600a165627a7a72305820bc8b6478ee59585031c79969344b9a113852e7a98d20f2fba1d29901ecd0d4e50029",
		//	},
		//	want: true,
		//},
		//{
		//	name: "KNC contract bytecode",
		//	args: args{
		//		bytecode: "608060405234801561001057600080fd5b506004361061018d5760003560e01c806370a08231116100e3578063a9059cbb1161008c578063db0e16f111610066578063db0e16f114610522578063dd62ed3e1461055b578063f2fde38b146105965761018d565b8063a9059cbb146104c4578063b4346169146104fd578063c49fc085146105055761018d565b80638da5cb5b116100bd5780638da5cb5b1461047b57806395d89b4114610483578063a457c2d71461048b5761018d565b806370a0823114610407578063715018a61461043a57806379cc6790146104425761018d565b80632c4d4d181161014557806340c10f191161011f57806340c10f191461037657806342966c68146103af578063485cc955146103cc5761018d565b80632c4d4d18146102ea578063313ce5671461031f578063395093511461033d5761018d565b8063095ea7b311610176578063095ea7b31461024057806318160ddd1461028d57806323b872dd146102a75761018d565b806306fdde0314610192578063075461721461020f575b600080fd5b61019a6105c9565b6040805160208082528351818301528351919283929083019185019080838360005b838110156101d45781810151838201526020016101bc565b50505050905090810190601f1680156102015780820380516001836020036101000a031916815260200191505b509250505060405180910390f35b61021761067e565b6040805173ffffffffffffffffffffffffffffffffffffffff9092168252519081900360200190f35b6102796004803603604081101561025657600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813516906020013561069a565b604080519115158252519081900360200190f35b6102956106b7565b60408051918252519081900360200190f35b610279600480360360608110156102bd57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135811691602081013590911690604001356106bd565b61031d6004803603602081101561030057600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610765565b005b61032761091a565b6040805160ff9092168252519081900360200190f35b6102796004803603604081101561035357600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135610923565b61031d6004803603604081101561038c57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135610984565b61031d600480360360208110156103c557600080fd5b5035610a63565b61031d600480360360408110156103e257600080fd5b5073ffffffffffffffffffffffffffffffffffffffff81358116916020013516610a74565b6102956004803603602081101561041d57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16610d5f565b61031d610d87565b61031d6004803603604081101561045857600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135610e9e565b610217610ef9565b61019a610f15565b610279600480360360408110156104a157600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135610f94565b610279600480360360408110156104da57600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813516906020013561100f565b610217611023565b61031d6004803603602081101561051b57600080fd5b503561103f565b61031d6004803603604081101561053857600080fd5b5073ffffffffffffffffffffffffffffffffffffffff8135169060200135611120565b6102956004803603604081101561057157600080fd5b5073ffffffffffffffffffffffffffffffffffffffff813581169160200135166111fb565b61031d600480360360208110156105ac57600080fd5b503573ffffffffffffffffffffffffffffffffffffffff16611233565b60688054604080516020601f60027fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156106735780601f1061064857610100808354040283529160200191610673565b820191906000526020600020905b81548152906001019060200180831161065657829003601f168201915b505050505090505b90565b60ca5473ffffffffffffffffffffffffffffffffffffffff1681565b60006106ae6106a76113d5565b84846113d9565b50600192915050565b60675490565b60006106ca848484611520565b61075a846106d66113d5565b610755856040518060600160405280602881526020016126f16028913973ffffffffffffffffffffffffffffffffffffffff8a166000908152606660205260408120906107216113d5565b73ffffffffffffffffffffffffffffffffffffffff168152602081019190915260400160002054919063ffffffff6116fe16565b6113d9565b5060015b9392505050565b60ca5473ffffffffffffffffffffffffffffffffffffffff1633146107eb57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600b60248201527f6f6e6c79206d696e746572000000000000000000000000000000000000000000604482015290519081900360640190fd5b73ffffffffffffffffffffffffffffffffffffffff811661086d57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600e60248201527f696e76616c6964206d696e746572000000000000000000000000000000000000604482015290519081900360640190fd5b60ca5473ffffffffffffffffffffffffffffffffffffffff8281169116146109175760ca5460405173ffffffffffffffffffffffffffffffffffffffff8084169216907f3b0007eb941cf645526cbb3a4fdaecda9d28ce4843167d9263b536a1f1edc0f690600090a360ca80547fffffffffffffffffffffffff00000000000000000000000000000000000000001673ffffffffffffffffffffffffffffffffffffffff83161790555b50565b606a5460ff1690565b60006106ae6109306113d5565b8461075585606660006109416113d5565b73ffffffffffffffffffffffffffffffffffffffff908116825260208083019390935260409182016000908120918c16815292529020549063ffffffff6117af16565b60ca5473ffffffffffffffffffffffffffffffffffffffff163314610a0a57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600b60248201527f6f6e6c79206d696e746572000000000000000000000000000000000000000000604482015290519081900360640190fd5b610a148282611823565b60ca5460405173ffffffffffffffffffffffffffffffffffffffff918216918391908516907ffd1ba5519feb014ad2f631cbd516bd3cec96be935749391554d122972593e7bf90600090a45050565b610917610a6e6113d5565b82611962565b600054610100900460ff1680610a8d5750610a8d611ab8565b80610a9b575060005460ff16155b610af0576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602e8152602001806126c3602e913960400191505060405180910390fd5b600054610100900460ff16158015610b5657600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff909116610100171660011790555b610bca6040518060400160405280601881526020017f4b79626572204e6574776f726b204372797374616c20763200000000000000008152506040518060400160405280600381526020017f4b4e430000000000000000000000000000000000000000000000000000000000815250611ac9565b610bd2611bf0565b73ffffffffffffffffffffffffffffffffffffffff8316610c5457604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600f60248201527f696e76616c6964206f6c64206b6e630000000000000000000000000000000000604482015290519081900360640190fd5b73ffffffffffffffffffffffffffffffffffffffff8216610cd657604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152600e60248201527f696e76616c6964206d696e746572000000000000000000000000000000000000604482015290519081900360640190fd5b60c9805473ffffffffffffffffffffffffffffffffffffffff8086167fffffffffffffffffffffffff00000000000000000000000000000000000000009283161790925560ca8054928516929091169190911790558015610d5a57600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff1690555b505050565b73ffffffffffffffffffffffffffffffffffffffff1660009081526065602052604090205490565b610d8f6113d5565b73ffffffffffffffffffffffffffffffffffffffff16610dad610ef9565b73ffffffffffffffffffffffffffffffffffffffff1614610e2f57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b60335460405160009173ffffffffffffffffffffffffffffffffffffffff16907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908390a3603380547fffffffffffffffffffffffff0000000000000000000000000000000000000000169055565b6000610edb8260405180606001604052806024815260200161271960249139610ece86610ec96113d5565b6111fb565b919063ffffffff6116fe16565b9050610eef83610ee96113d5565b836113d9565b610d5a8383611962565b60335473ffffffffffffffffffffffffffffffffffffffff1690565b60698054604080516020601f60027fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff6101006001881615020190951694909404938401819004810282018101909252828152606093909290918301828280156106735780601f1061064857610100808354040283529160200191610673565b60006106ae610fa16113d5565b84610755856040518060600160405280602581526020016127d16025913960666000610fcb6113d5565b73ffffffffffffffffffffffffffffffffffffffff908116825260208083019390935260409182016000908120918d1681529252902054919063ffffffff6116fe16565b60006106ae61101c6113d5565b8484611520565b60c95473ffffffffffffffffffffffffffffffffffffffff1681565b60c954604080517f79cc679000000000000000000000000000000000000000000000000000000000815233600482015260248101849052905173ffffffffffffffffffffffffffffffffffffffff909216916379cc6790916044808201926020929091908290030181600087803b1580156110b957600080fd5b505af11580156110cd573d6000803e3d6000fd5b505050506040513d60208110156110e357600080fd5b506110f090503382611823565b604051819033907f8b80bd19aea7b735bc6d75db8d6adbe18b28c30d62b3555245eb67b2340caedc90600090a350565b6111286113d5565b73ffffffffffffffffffffffffffffffffffffffff16611146610ef9565b73ffffffffffffffffffffffffffffffffffffffff16146111c857604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b6111f76111d3610ef9565b73ffffffffffffffffffffffffffffffffffffffff8416908363ffffffff611d1316565b5050565b73ffffffffffffffffffffffffffffffffffffffff918216600090815260666020908152604080832093909416825291909152205490565b61123b6113d5565b73ffffffffffffffffffffffffffffffffffffffff16611259610ef9565b73ffffffffffffffffffffffffffffffffffffffff16146112db57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181905260248201527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604482015290519081900360640190fd5b73ffffffffffffffffffffffffffffffffffffffff8116611347576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602681526020018061262f6026913960400191505060405180910390fd5b60335460405173ffffffffffffffffffffffffffffffffffffffff8084169216907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e090600090a3603380547fffffffffffffffffffffffff00000000000000000000000000000000000000001673ffffffffffffffffffffffffffffffffffffffff92909216919091179055565b3390565b73ffffffffffffffffffffffffffffffffffffffff8316611445576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260248152602001806127836024913960400191505060405180910390fd5b73ffffffffffffffffffffffffffffffffffffffff82166114b1576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260228152602001806126556022913960400191505060405180910390fd5b73ffffffffffffffffffffffffffffffffffffffff808416600081815260666020908152604080832094871680845294825291829020859055815185815291517f8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b9259281900390910190a3505050565b73ffffffffffffffffffffffffffffffffffffffff831661158c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602581526020018061275e6025913960400191505060405180910390fd5b73ffffffffffffffffffffffffffffffffffffffff82166115f8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825260238152602001806125ea6023913960400191505060405180910390fd5b611603838383610d5a565b611653816040518060600160405280602681526020016126776026913973ffffffffffffffffffffffffffffffffffffffff8616600090815260656020526040902054919063ffffffff6116fe16565b73ffffffffffffffffffffffffffffffffffffffff8085166000908152606560205260408082209390935590841681522054611695908263ffffffff6117af16565b73ffffffffffffffffffffffffffffffffffffffff80841660008181526065602090815260409182902094909455805185815290519193928716927fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef92918290030190a3505050565b600081848411156117a7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004018080602001828103825283818151815260200191508051906020019080838360005b8381101561176c578181015183820152602001611754565b50505050905090810190601f1680156117995780820380516001836020036101000a031916815260200191505b509250505060405180910390fd5b505050900390565b60008282018381101561075e57604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601b60248201527f536166654d6174683a206164646974696f6e206f766572666c6f770000000000604482015290519081900360640190fd5b73ffffffffffffffffffffffffffffffffffffffff82166118a557604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601f60248201527f45524332303a206d696e7420746f20746865207a65726f206164647265737300604482015290519081900360640190fd5b6118b160008383610d5a565b6067546118c4908263ffffffff6117af16565b60675573ffffffffffffffffffffffffffffffffffffffff82166000908152606560205260409020546118fd908263ffffffff6117af16565b73ffffffffffffffffffffffffffffffffffffffff831660008181526065602090815260408083209490945583518581529351929391927fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9281900390910190a35050565b73ffffffffffffffffffffffffffffffffffffffff82166119ce576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602181526020018061273d6021913960400191505060405180910390fd5b6119da82600083610d5a565b611a2a8160405180606001604052806022815260200161260d6022913973ffffffffffffffffffffffffffffffffffffffff8516600090815260656020526040902054919063ffffffff6116fe16565b73ffffffffffffffffffffffffffffffffffffffff8316600090815260656020526040902055606754611a63908263ffffffff611da016565b60675560408051828152905160009173ffffffffffffffffffffffffffffffffffffffff8516917fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef9181900360200190a35050565b6000611ac330611e17565b15905090565b600054610100900460ff1680611ae25750611ae2611ab8565b80611af0575060005460ff16155b611b45576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602e8152602001806126c3602e913960400191505060405180910390fd5b600054610100900460ff16158015611bab57600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff909116610100171660011790555b611bb3611e1d565b611bbd8383611f2f565b8015610d5a57600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff169055505050565b600054610100900460ff1680611c095750611c09611ab8565b80611c17575060005460ff16155b611c6c576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602e8152602001806126c3602e913960400191505060405180910390fd5b600054610100900460ff16158015611cd257600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff909116610100171660011790555b611cda611e1d565b611ce2612097565b801561091757600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff16905550565b6040805173ffffffffffffffffffffffffffffffffffffffff8416602482015260448082018490528251808303909101815260649091019091526020810180517bffffffffffffffffffffffffffffffffffffffffffffffffffffffff167fa9059cbb00000000000000000000000000000000000000000000000000000000179052610d5a908490612227565b600082821115611e1157604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601e60248201527f536166654d6174683a207375627472616374696f6e206f766572666c6f770000604482015290519081900360640190fd5b50900390565b3b151590565b600054610100900460ff1680611e365750611e36611ab8565b80611e44575060005460ff16155b611e99576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602e8152602001806126c3602e913960400191505060405180910390fd5b600054610100900460ff16158015611ce257600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff90911661010017166001179055801561091757600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff16905550565b600054610100900460ff1680611f485750611f48611ab8565b80611f56575060005460ff16155b611fab576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602e8152602001806126c3602e913960400191505060405180910390fd5b600054610100900460ff1615801561201157600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff909116610100171660011790555b8251612024906068906020860190612551565b508151612038906069906020850190612551565b50606a80547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff001660121790558015610d5a57600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff169055505050565b600054610100900460ff16806120b057506120b0611ab8565b806120be575060005460ff16155b612113576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602e8152602001806126c3602e913960400191505060405180910390fd5b600054610100900460ff1615801561217957600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff007fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff909116610100171660011790555b60006121836113d5565b603380547fffffffffffffffffffffffff00000000000000000000000000000000000000001673ffffffffffffffffffffffffffffffffffffffff8316908117909155604051919250906000907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908290a350801561091757600080547fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00ff16905550565b6060612289826040518060400160405280602081526020017f5361666545524332303a206c6f772d6c6576656c2063616c6c206661696c65648152508573ffffffffffffffffffffffffffffffffffffffff166122ff9092919063ffffffff16565b805190915015610d5a578080602001905160208110156122a857600080fd5b5051610d5a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602a8152602001806127a7602a913960400191505060405180910390fd5b606061230e8484600085612316565b949350505050565b606082471015612371576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040180806020018281038252602681526020018061269d6026913960400191505060405180910390fd5b61237a85611e17565b6123e557604080517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820152601d60248201527f416464726573733a2063616c6c20746f206e6f6e2d636f6e7472616374000000604482015290519081900360640190fd5b600060608673ffffffffffffffffffffffffffffffffffffffff1685876040518082805190602001908083835b6020831061244f57805182527fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe09092019160209182019101612412565b6001836020036101000a03801982511681845116808217855250505050505090500191505060006040518083038185875af1925050503d80600081146124b1576040519150601f19603f3d011682016040523d82523d6000602084013e6124b6565b606091505b50915091506124c68282866124d1565b979650505050505050565b606083156124e057508161075e565b8251156124f05782518084602001fd5b6040517f08c379a000000000000000000000000000000000000000000000000000000000815260206004820181815284516024840152845185939192839260440191908501908083836000831561176c578181015183820152602001611754565b828054600181600116156101000203166002900490600052602060002090601f016020900481019282601f1061259257805160ff19168380011785556125bf565b828001600101855582156125bf579182015b828111156125bf5782518255916020019190600101906125a4565b506125cb9291506125cf565b5090565b61067b91905b808211156125cb57600081556001016125d556fe45524332303a207472616e7366657220746f20746865207a65726f206164647265737345524332303a206275726e20616d6f756e7420657863656564732062616c616e63654f776e61626c653a206e6577206f776e657220697320746865207a65726f206164647265737345524332303a20617070726f766520746f20746865207a65726f206164647265737345524332303a207472616e7366657220616d6f756e7420657863656564732062616c616e6365416464726573733a20696e73756666696369656e742062616c616e636520666f722063616c6c496e697469616c697a61626c653a20636f6e747261637420697320616c726561647920696e697469616c697a656445524332303a207472616e7366657220616d6f756e74206578636565647320616c6c6f77616e636545524332303a206275726e20616d6f756e74206578636565647320616c6c6f77616e636545524332303a206275726e2066726f6d20746865207a65726f206164647265737345524332303a207472616e736665722066726f6d20746865207a65726f206164647265737345524332303a20617070726f76652066726f6d20746865207a65726f20616464726573735361666545524332303a204552433230206f7065726174696f6e20646964206e6f74207375636365656445524332303a2064656372656173656420616c6c6f77616e63652062656c6f77207a65726fa2646970667358221220c3125ea4dd6750047a3bb3653cd46a2bafac324da3126bf4a1591284f0002e7164736f6c63430006060033",
		//	},
		//	want: true,
		//},
	}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			data, err := hex.DecodeString(tt.args.bytecode)
			assert.NoError(t, err)
			got := IsErc20(data)
			if got != tt.want {
				t.Errorf("IsErc20() = %v, want %v", got, tt.want)
			}
		})
	}
}

func Test_getMethodHash(t *testing.T) {
	type args struct {
		method string
	}
	tests := []struct {
		name string
		args args
		want string
	}{
		{
			name: "basic evm opcode",
			args: args{
				method: "totalSupply()",
			},
			want: "0x18160ddd",
		}}
	for _, tt := range tests {
		t.Run(tt.name, func(t *testing.T) {
			assert.Equalf(t, tt.want, getMethodHash(tt.args.method), "getMethodHash(%v)", tt.args.method)
		})
	}
}
